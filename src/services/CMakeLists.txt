include_directories("../common")

set(CALIPER_SERVICES_SOURCES
    Services.cpp)

add_library(caliper-services ${CALIPER_SERVICES_SOURCES})

if (LIBUNWIND_FOUND)
  target_link_libraries(caliper-services caliper-callpath)
endif()
if (PAPI_FOUND)
  target_link_libraries(caliper-services caliper-papi)
endif()
target_link_libraries(caliper-services caliper-debug)
target_link_libraries(caliper-services caliper-pthread)
target_link_libraries(caliper-services caliper-recorder)
target_link_libraries(caliper-services caliper-timestamp)
if (Mitos_FOUND)
  target_link_libraries(caliper-services caliper-mitos)
endif()
if (MPI_C_FOUND)
  target_link_libraries(caliper-services caliper-mpi)
endif()
if (OMPT_FOUND)
  target_link_libraries(caliper-services caliper-ompt)
endif()
target_link_libraries(caliper-services caliper-common)

install(TARGETS caliper-services DESTINATION lib)

if (LIBUNWIND_FOUND)
  add_subdirectory(callpath)
endif()
if (PAPI_FOUND)
  add_subdirectory(papi)
endif()
add_subdirectory(debug)
add_subdirectory(pthread)
add_subdirectory(recorder)
add_subdirectory(timestamp)
if (MPI_C_FOUND)
  add_subdirectory(mpiwrap)
endif()
if (Mitos_FOUND)
  add_subdirectory(mitos)
endif()
if (OMPT_FOUND)
  add_subdirectory(ompt)
endif()
